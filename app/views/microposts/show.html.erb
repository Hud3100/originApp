<div class="content-container container col-md-8 col-sm-10">
  <div class="micropost-detail-title">
    <h3><%= @micropost.title %></h3>
  </div>
  <div class="micropost-table-content col-md-8 col-sm-10 no-gutters">
    <table class="table table-sm">
      <tr>
        <th scope="row">車名</th>
        <td><%= @micropost.car_name %></td>
      </tr>
      <tr>
        <th scope="row">予算</th>
        <td><%= @micropost.budget %>万円</td>
      </tr>
      <tr>
        <th scope="row">掲載日</td>
        <td><%= @micropost.created_at.strftime("%Y-%m-%d %H:%M") %></td>
      </tr>
    </table>
  </div>
  <div class="row">
    <div class="micropost-images-container col-lg-5 col-sm-12">
        <% if @micropost.images&.any? %>
          <div id="example-2" class="carousel slide carousel-fade" data-ride="carousel" data-pause="hover">
            <ol class="carousel-indicators">
              <% @micropost.images.count.times do |count| %>
                <li data-target="example-3" data-slide-to="<%= count %>" class=<%= "active" if count.zero? %>></li>
              <% end %>
            </ol>
            <div class="carousel-inner">
              <% @micropost.images.each_with_index do |image, i| %>
                <div class="carousel-item <%= "active" if i.zero? %>">
                  <%= image_tag image.img.url, class: "d-block w-100", size: "400x300" %>
                </div>
              <% end %>
              <a class="carousel-control-prev" href="#example-2" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" href="#example-2" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
          </div>
        <% end %>
    </div>
    <div class="micropost-detail-content col-lg-7 col-sm-12">
      <%= @micropost.content %>
    </div>
  </div>
<h2>コメント一覧</h2>
  <% @micropost.comments.each do |c| %>
    <div>
      <p><%= c.content %></p>
      <% unless c.images.blank? %>
          <% c.images.each do |image| %>
            <img src = <%= image.img.url %>>
          <% end %>
      <% end %>
    </div>
  <% end %>

<% if company_signed_in? %>
  <h3>この車への提案はこちらから</h3>
  <div class="form_comment">
    <%= form_with(model: [@micropost, @comment], local: true) do |f| %>
      <div class="form-group">
        <%= f.label :title, "タイトル" %>
        <%= f.text_field :title %>
      </div>
      <div class="form-group">
        <%= f.label :content, "コメント内容" %>
        <%= f.text_area :content , class: "form-control", rows: 10 %>
      </div>
      <br>
        <%= f.fields_for :images do |i| %>
          <%= i.file_field :img %>
        <% end %>
      <%= f.submit 'コメントする' %>
    <% end %>
  </div>
<% end %>
<%= link_to "ホームへ戻る", root_path%>
</div>
